(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-769ecec6"],{"2fdb":function(e,t,a){"use strict";var n=a("5ca1"),o=a("d2c8"),i="includes";n(n.P+n.F*a("5147")(i),"String",{includes:function(e){return!!~o(this,e,i).indexOf(e,arguments.length>1?arguments[1]:void 0)}})},5147:function(e,t,a){var n=a("2b4c")("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(a){try{return t[n]=!1,!"/./"[e](t)}catch(o){}}return!0}},6762:function(e,t,a){"use strict";var n=a("5ca1"),o=a("c366")(!0);n(n.P,"Array",{includes:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")("includes")},"73a6":function(e,t,a){"use strict";var n=a("75fc");t["a"]={data:function(){return{requestUrl:""}},methods:{pageFormSearchBtnCallback:function(){var e=this;return new Promise((function(t,a){e.changeTablePagination({page:1}),e.requestList().finally((function(){return t()}))}))},pageFormResetBtnCallback:function(){var e=this;return new Promise((function(t,a){e.$refs.pageFormRefs.resetData(),e.changeTablePagination({page:1}),e.requestList().finally((function(){return t()}))}))},createTableData:function(e){try{this.beforCreateTableCallback?this.beforCreateTableCallback(e):(this.pageTableOptions.data=Object(n["a"])(e.list),this.pageTableOptions.pagination&&(this.pageTableOptions.pagination.total=e.totalCount)),this.pageLoading(!1)}catch(t){this.pageTableOptions&&(this.pageTableOptions.data=[]),this.pageLoading(!1)}},pageLoading:function(e){this.pageTableOptions&&(this.pageTableOptions.loading=e)},requestList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;return a&&(this.requestUrl=a),new Promise((function(a){var n=e.$refs.pageFormRefs?_.pickBy(e.$refs.pageFormRefs.getData(),(function(e){return""!==e})):{},o=e.pageTableOptions&&e.pageTableOptions.pagination?{page:e.pageTableOptions.pagination.page,pageSize:e.pageTableOptions.pagination.pageSize}:{},i=e.handlerExtraParams?e.handlerExtraParams():{};t=Object.assign({},n,o,t,i),e.pageLoading(!0),e.beforRequestCallback&&e.beforRequestCallback(),e.pageTableOptions&&(e.pageTableOptions.data=[]),e.$http.post(e.requestUrl,t).then((function(t){var n=t.data;e.handlerTableData?e.handlerTableData(n):e.createTableData(n.page),a()})).finally((function(){a(),e.pageLoading(!1)}))}))},add:function(){this.$refs.pageModalFormRefs.resetData(),this.pageModalOptions.show=!0},okPageModal:function(){var e=this,t=this.$refs.pageModalFormRefs;t.$refs.form.validate((function(a){if(a){var n=t.getData();e.pageModalOptions.btnLoading=!0;var o=e.handlerModalData?e.handlerModalData(n):n;e.$http.post(e.modalRequestUrl,o).then((function(t){e.pageModalOptions.show=!1,e.tips("操作成功"),e.okPageModalSuccess?e.okPageModalSuccess():e.requestList()})).finally((function(){e.pageModalOptions.btnLoading=!1}))}}))},cancelPageModal:function(){this.pageModalOptions.show=!1},changeTablePagination:function(e){this.pageTableOptions&&this.pageTableOptions.pagination&&(this.pageTableOptions.pagination=Object.assign({},this.pageTableOptions.pagination,e))},tips:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"成功";this.$Notice[t]({title:a,desc:e})},modalConfirm:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"您确定要删除该条数据吗？",n=this;this.$Modal.confirm({title:"提示",content:a,onOk:function(){n.pageLoading(!0),this.$http.post(e,t).then((function(e){0===e.data.code&&(n.tips("删除成功"),n.requestList())})).finally((function(){n.pageLoading(!1)}))},onCancel:function(){}})}}}},"9aad":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.pageModalOptions.show?a("PageModal",{attrs:{options:e.pageModalOptions},on:{ok:e.okPageModal,cancel:e.cancelPageModal}},[a("PageForm",{ref:"pageModalFormRefs",attrs:{options:e.pageModalFormOptions}})],1):e._e()},o=[],i=a("a00a"),s=a("dad9"),r=a("28e6"),l={name:"PageResetPassword",props:["userId","url"],data:function(){var e=this;return{pwdType:"",pageModalOptions:{show:!1,btnLoading:!1,title:"修改密码"},pageModalFormOptions:{modalForm:!0,labelWidth:80,config:[{id:"oldpassword",type:"input",name:"原密码",options:{type:"password",value:"",placeholder:"请输入原密码",hidden:function(){return"self"!==e.pwdType}}},{id:"password",type:"input",name:"密码",options:{type:"password",value:""}},{id:"agentPassword",type:"input",name:"确认密码",options:{type:"password",value:""}}],rules:{oldpassword:[{required:!0,message:"请输入密码",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:r["a"].of().validate.passwordlength,trigger:"blur"}],agentPassword:[{required:!0,message:"请输入确认密码",trigger:"blur"},{validator:r["a"].of().validate.passwordlength,trigger:"blur"},{validator:function(t,a,n){e.$refs.pageModalFormRefs.getData().password!=a?n(new Error("两次密码输入不一致")):n()},trigger:"blur"}]}}}},methods:{okPageModal:function(){var e=this,t=this,a=this.$refs.pageModalFormRefs;a.$refs.form.validate((function(n){if(n){var o=e.url||i["b"].commonResetPassword,r={userId:t.userId,newPassword:s["a"].of().md5(a.getData().password)};t.$http.post(o,r).then((function(e){t.pageModalOptions.show=!1,t.$Notice.success({title:"成功",desc:"操作成功"})})).finally((function(){t.pageModalOptions.btnLoading=!1}))}}))},cancelPageModal:function(){this.pageModalOptions.show=!1},open:function(e){e&&(this.pwdType=e),this.pageModalOptions.show=!0}}},p=l,d=p,g=a("2877"),u=Object(g["a"])(d,n,o,!1,null,null,null);t["a"]=u.exports},bc51:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user-management"},[a("PageTitle",{attrs:{options:e.pageTitleOptions}},[a("Button",{attrs:{slot:"setting",type:"primary"},on:{click:e.addUser},slot:"setting"},[e._v("新增")])],1),a("PageForm",{ref:"pageFormRefs",attrs:{options:e.pageFormOptions}}),a("PageTable",{attrs:{options:e.pageTableOptions},on:{"change-table-pagination":e.changeTablePagination}}),a("PageModal",{attrs:{options:e.pageModalOptions},on:{ok:e.okPageModal,cancel:e.cancelPageModal}},[a("PageForm",{ref:"pageModalFormRefs",attrs:{options:e.pageModalFormOptions}})],1),a("PageResetPassword",{ref:"resetPasswordRef",attrs:{userId:e.currentRow.id}})],1)},o=[],i=(a("6762"),a("2fdb"),a("ac6a"),a("7f7f"),a("28a5"),a("a00a")),s=(a("2ef0"),a("28e6")),r=a("dad9"),l=a("9aad"),p=a("73a6"),d={name:"userManagement",components:{PageResetPassword:l["a"]},mixins:[p["a"]],data:function(){this.$createElement;var e=this;return{isEdit:!1,currentRow:{},roleList:[],pageTitleOptions:{name:""},pageFormOptions:{inline:!0,config:[{id:"userName",type:"input",name:"账号",options:{value:""}},{id:"roleId",type:"select",name:"帐号类型",options:{value:"",list:[{label:"全部",value:""}]}},{id:"submit",type:"button",name:"查询",options:{click:function(){return e.pageFormSearchBtnCallback()}}},{id:"reset",type:"button",name:"重置",options:{type:"default",click:function(){return e.pageFormResetBtnCallback()}}}]},pageTableOptions:{loading:!1,requestList:this.requestList,header:[{title:"用户名",key:"userName",align:"center"},{title:"账户类型",key:"rolesList",align:"center",render:function(e,t){var a=t.row;return a.rolesList&&a.rolesList.split(",").map((function(e){return i["a"][e]}))}},{title:"登入账号",key:"name",align:"center"},{title:"创建人",key:"createUserName",align:"center"},{title:"操作",key:"operates",align:"center",render:function(t,a){var n=a.row;return t("PageTableTool",{attrs:{options:[{name:"重置密码",permission:!1,click:e.handleResetPassword.bind(e,n)},{name:"编辑",permission:!1,click:e.handleEdit.bind(e,n)}]}})}}],data:[],pagination:{pageSize:20,total:0,page:1}},pageModalOptions:{show:!1,btnLoading:!1,title:"新增用户"},pageModalFormOptions:{modalForm:!0,labelWidth:80,config:[{id:"userName",type:"input",name:"用户名",options:{value:"",disabled:!1}},{id:"name",type:"input",name:"昵称",options:{value:"",disabled:!1}},{id:"password",type:"input",name:"密码",options:{type:"password",value:"",disabled:!1}},{id:"roles",type:"radio",name:"角色",options:{value:"",list:[],disabled:!1}},{id:"remark",type:"input",name:"备注",options:{value:""}}],rules:{userName:[{required:!0,message:"请输入用户名",trigger:"blur"},{validator:s["a"].of().validate.userlength,trigger:"blur"}],name:[{required:!0,message:"请输入登入帐号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:s["a"].of().validate.passwordlength,trigger:"blur"}],roles:[{required:!0,message:"请选择角色类型",trigger:"blur"}]}}}},mounted:function(){this.requestList({},i["b"].getUserList),this.requestRoleList()},methods:{requestRoleList:function(){var e=this;this.roleList&&0!=this.roleList.length||this.$http.post(i["b"].getRoleList,{groupDesk:0}).then((function(t){var a=t.data;a.page.list.map((function(t){var a={id:t.id,name:t.name};e.roleList.push(a)}))}))},addUser:function(){this.isEdit=!1,this.pageModalFormOptions.config=this.getModelConfig(),this.requestRoleList(),this.pageModalOptions.show=!0,this.$refs.pageModalFormRefs&&this.$refs.pageModalFormRefs.resetData()},handleResetPassword:function(e){this.currentRow=Object.assign({},e),this.$refs.resetPasswordRef.open()},handleSelfCode:function(e){this.currentRow=Object.assign({},e)},handleDel:function(e){var t=this;this.$Modal.confirm({title:"提示",content:"您确定要删除".concat(e.name,"数据吗?"),onOk:function(){t.$http.post(i["b"].deleteUser,{userIds:[e.id]}).then((function(e){t.pageModalOptions.show=!1,t.tips(),t.requestList()})).finally((function(){t.pageModalOptions.btnLoading=!1}))}})},handleEdit:function(e){this.pageModalOptions.show=!0,this.currentRow=Object.assign({},e),this.isEdit=!0;var t=this.getModelConfig();t.forEach((function(t){"roles"===t.id?(t.options.value=e.rolesList,t.options.list.forEach((function(e){return e.disabled=!0}))):t.options&&(t.options.value=e[t.id])})),this.pageModalFormOptions=Object.assign({},this.pageModalFormOptions,{config:t})},okPageModal:function(){var e=this,t=this.$refs.pageModalFormRefs;t.$refs.form.validate((function(a){if(a){var n=t.getData();n.password=r["a"].of().md5(n.password),n.roleIdList=[n.roles],delete n.roles,e.pageModalOptions.btnLoading=!0,e.currentRow={},e.$http.post(i["b"].addUser,n).then((function(t){e.pageModalOptions.show=!1,e.tips(),e.requestList()})).finally((function(){e.pageModalOptions.btnLoading=!1}))}}))},cancelPageModal:function(){this.pageModalOptions.show=!1,this.currentRow={}},getModelConfig:function(){var e=this,t=this.pageModalFormOptions.config;return t.forEach((function(t){["userName","name","password","roles"].includes(t.id)&&(t.options.disabled=e.isEdit),"roles"==t.id&&(t.options.list=e.roleList)})),t}}},g=d,u=g,c=a("2877"),f=Object(c["a"])(u,n,o,!1,null,null,null);t["default"]=f.exports},d2c8:function(e,t,a){var n=a("aae3"),o=a("be13");e.exports=function(e,t,a){if(n(t))throw TypeError("String#"+a+" doesn't accept regex!");return String(o(e))}}}]);